<UserControl x:Class="AutoMerge.BranchesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:autoMerge="clr-namespace:AutoMerge;assembly="
             mc:Ignorable="d"
             UseLayoutRounding="True"
             TextOptions.TextFormattingMode="Display"
             d:DesignHeight="300" d:DesignWidth="300"
             DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <UserControl.Resources>
        <autoMerge:BranchNameConverter x:Key="BranchNameConverter" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <DataTemplate x:Key="BranchItemTemplate" DataType="autoMerge:MergeInfoModel">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <CheckBox Grid.Column="0" IsChecked="{Binding Checked, Mode=TwoWay}" Visibility="{Binding CanMerge, Converter={StaticResource BooleanToVisibilityConverter}}" IsThreeState="False" />
                <TextBlock Grid.Column="1" Text="{Binding TargetBranch, Converter={StaticResource BranchNameConverter}}"></TextBlock>
            </Grid>
        </DataTemplate>
        <Style x:Key="BranchesListStyle" TargetType="ListBox" BasedOn="{StaticResource {x:Type ListBox}}">
            <Setter Property="ItemTemplate" Value="{StaticResource BranchItemTemplate}" />
            <Setter Property="SelectionMode" Value="Single" />
        </Style>
    </UserControl.Resources>
    <DockPanel>
        <WrapPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,6">
            <Button Click="Merge">Merge</Button>
        </WrapPanel>
        <ListBox ItemsSource="{Binding Path=ParentSection.Branches}"
                 Style="{DynamicResource BranchesListStyle}">
        </ListBox>
<!--        <ListView ItemsSource="{Binding Path=ParentSection.Branches}" BorderThickness="0" -->
<!--                  SelectionMode="Single" ScrollViewer.HorizontalScrollBarVisibility="Hidden">-->
<!--            <ListView.View>-->
<!--                <GridView>-->
<!--                    <GridView.ColumnHeaderContainerStyle>-->
<!--                        <Style>-->
<!--                            <Setter Property="FrameworkElement.Visibility" Value="Collapsed"/>-->
<!--                        </Style>-->
<!--                    </GridView.ColumnHeaderContainerStyle>-->
<!--                    <GridViewColumn>-->
<!--                        <GridViewColumn.CellTemplate>-->
<!--                            <DataTemplate>-->
<!--                                <CheckBox IsChecked="{Binding Checked, Mode=TwoWay}" Visibility="{Binding CanMerge, Converter={StaticResource BooleanToVisibilityConverter}}" IsThreeState="False" />-->
<!--                            </DataTemplate>-->
<!--                        </GridViewColumn.CellTemplate>-->
<!--                    </GridViewColumn>-->
<!--                    <GridViewColumn Header="Target">-->
<!--                        <GridViewColumn.CellTemplate>-->
<!--                            <DataTemplate>-->
<!--                                <TextBlock Text="{Binding TargetBranch, Converter={StaticResource BranchNameConverter}}"></TextBlock>-->
<!--                            </DataTemplate>-->
<!--                        </GridViewColumn.CellTemplate>-->
<!--                    </GridViewColumn>-->
<!--                </GridView>-->
<!--            </ListView.View>-->
<!--            <ListView.ItemContainerStyle>-->
<!--                <Style TargetType="ListViewItem">-->
<!--                    <Setter Property="Foreground" Value="{DynamicResource {x:Static autoMerge:EnvironmentColors.ToolWindowTextBrushKey}}"/>-->
<!--                    <Style.Triggers>-->
<!--                        <DataTrigger Binding="{Binding IsCurrentBranch}" Value="true">-->
<!--                            <Setter Property="FontWeight" Value="Light" />-->
<!--                            ~1~<Setter Property="IsEnabled" Value="False"></Setter>@1@-->
<!--                        </DataTrigger>-->
<!--                    </Style.Triggers>-->
<!--                </Style>-->
<!--            </ListView.ItemContainerStyle>-->
<!--        </ListView>-->
    </DockPanel>
</UserControl>
